@using YomLog.Domain.Books.Interfaces
@using YomLog.Domain.Books.Commands
@using YomLog.MobileApp.Components

@page "/"
@inject IBookRepository BookRepository
@inject LayoutService LayoutService

<PageContainer TopPage="true">
    <MudGrid Spacing="2">
        @foreach (var item in MyBooks)
        {
            <MudItem xs="12" lg="6">
                <BookItem Item="item" />
            </MudItem>
        }
    </MudGrid>
</PageContainer>

@code {
    private List<BookCommandDTO> MyBooks { get; set; } = new();

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender) return;

        LayoutService.IsProcessing.Value = true;
        MyBooks = (await BookRepository.FindAllAsync()).Select(x => x.ToCommand()).ToList();
        LayoutService.IsProcessing.Value = false;
        StateHasChanged();
    }
}